<h1><%= @school.name %></h1>

<h2>Pie chart: Positive vs. Negative</h2>
    <script type="text/javascript">

      //Width and height
      var w = 300;
      var h = 300;

      // var dataset = [ 60, 30, 10];

      var dataset = [ {label: "Good", value: 60},
                      {label: "Bad", value: 30},
                      {label: "Eh?", value: 60}]

      var json = '<%= @social_media_profile.html_safe %>';
      var social = jQuery.parseJSON(json);

      var outerRadius = w / 2;
      var innerRadius = w / 4;
      var arc = d3.svg.arc()
              .innerRadius(innerRadius)
              .outerRadius(outerRadius);

      var pie = d3.layout.pie();

      // purple is nice
      var color = d3.scale.category20b();

      //Create SVG element
      var svg = d3.select("body")
            .append("svg")
            .attr("width", w)
            .attr("height", h);

      //Set up groups
      var arcs = svg.selectAll("g.arc")
              .data(pie(dataset))
              .enter()
              .append("g")
              .attr("class", "arc")
              .attr("transform", "translate(" + outerRadius + "," + outerRadius + ")");

      //Draw arc paths
      arcs.append("path")
          .attr("fill", function(d, i) {
            return color(i);
          })
          .attr("d.value", arc);

      //Labels
      arcs.append("text")
          .attr("transform", function(d) {
            return "translate(" + arc.centroid(d) + ")";
          })
          .attr("text-anchor", "middle")
          .text(function(d) {
            return d;
          });

      svg.append("text")
          // .attr("transform", function(d) {
          //   return "translate(" + arc.centroid(d) + ")";
          // })
          // .attr("text-anchor", "middle")
          .text(function(d) {
            return "hello";
          });

    </script>

<h2>Student body count: <%= @school.student_body_count %></h2>
<h2>Post (Social media) count: <%= @school.post_count %></h2>
<h2>Social Media Activity: <%= @school.social_media_activity %></h2>
<h2>Positive Vibe Count: <%= @school.positive_vibe_ratio %></h2>
<h2>Negative Vibe Count: <%= @school.negative_vibe_ratio %></h2>
<h2>Neutral Vibe Count*: <%= @school.neutral_vibe_ratio %></h2>
<h2>Mixed Vibe Count*: <%= @school.mixed_vibe_ratio %></h2>
<p>*mixed_vibe_ratio may be dropped from final product</p>


<h1>Ratings</h1>

<table>
  <tr>
    <td>Rating ID</td>
    <td>Topic</td>
    <td>School</td>
    <td>Activity</td>
    <td>Pos</td>
    <td>Neg</td>
    <td>Neu</td>
    <td>Mix</td>
  </tr>

  <% @ratings.each do |rating| %>

  <tr>
    <td><%= rating.id %></td>
    <td>(<%= rating.topic_id %>) <%= rating.topic.name %></td>
    <td>(<%= rating.school_id %>) <%= rating.school.name %></td>
    <td><%= rating.topic_activity_ratio %></td>
    <td><%= rating.topic_positivity_ratio %></td>
    <td><%= rating.topic_negativity_ratio %></td>
    <td><%= rating.topic_neutral_ratio %></td>
    <td><%= rating.topic_mixed_ratio %></td>
  </tr>

  <% end %>

</table>
